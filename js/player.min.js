/*
	Project: blinkx/Tizen HTML5 Video Player
	This open source project was created by blinkx for the Tizen community. It is released under the ??? license.
	Website: www.blinkx.com
	@author Jasper Valero
*/$(function(){"use strict";var e={playerDiv:$(".blinkx-player"),playlistURL:"data/playlist.json",dataType:"json",playerWidth:"320",playerHeight:"180",controlsEnabled:!0,autoplayEnabled:!1,autoplayNext:!1,player:null,playlist:null,numPlaylistItems:null,currentPosition:null,init:function(){var e=this;this.playerDiv.html(function(){var t='<video width="'+e.playerWidth+'" height="'+e.playerHeight+'" ';e.controlsEnabled&&(t+="controls ");e.autoplayEnabled&&(t+='autoplay="autoplay" ');t+="></video>";return t});this.player=this.playerDiv.children("video");this.fetchPlaylist();this.player.bind("click",function(){this.play()});this.playerDiv.siblings(".test").find(".prev").bind("click",function(){console.log("Prev");e.loadPreviousVideo()});this.playerDiv.siblings(".test").find(".next").bind("click",function(){console.log("Next");e.loadNextVideo()});this.autoplayNext&&this.player.bind("ended",function(){console.log("Video ended.");e.loadNextVideo()})},fetchPlaylist:function(){var e=this;$.ajax({url:this.playlistURL,dataType:this.dataType}).done(function(t){var n=e.getNumPlaylistItems(t);e.dataType.toLowerCase()==="json"?e.playlist=t:e.dataType.toLowerCase()==="xml"&&(e.playlist=e.xmlToJson(t));e.loadFirstVideo();console.log(""+n+" playlist items fetched successfully!")}).fail(function(){console.error("There was a problem fetching the playlist. Please double check the playlistURL and dataType and try again.")}).always(function(){})},getNumPlaylistItems:function(e){if(this.dataType.toLowerCase()==="json"){this.numPlaylistItems=e.tracks.length;return e.tracks.length}if(this.dataType.toLowerCase()==="xml"){this.numPlaylistItems=$(e).find("track").length;return $(e).find("track").length}},loadFirstVideo:function(){var e=this;this.currentPosition=0;this.player.prop({src:e.playlist.tracks[0].file,poster:e.playlist.tracks[0].image})},loadNextVideo:function(){var e=this;this.currentPosition=this.currentPosition+1;this.currentPosition>this.numPlaylistItems-1&&(this.currentPosition=0);this.player.prop({src:e.playlist.tracks[this.currentPosition].file,poster:e.playlist.tracks[this.currentPosition].image})},loadPreviousVideo:function(){var e=this;this.currentPosition--;this.currentPosition<0&&(this.currentPosition=this.numPlaylistItems-1);this.player.prop({src:e.playlist.tracks[this.currentPosition].file,poster:e.playlist.tracks[this.currentPosition].image})},xmlToJson:function(e){var t=this,n={tracks:[]};for(var r=0;r<this.numPlaylistItems;r++){var i=$(e).find("track")[r],s=$(i).find("file").text(),o=$(i).find("title").text(),u=$(i).find("image").text();n.tracks[r]={file:s,title:o,image:u}}return n}};e.init()});